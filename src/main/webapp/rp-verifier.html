<!DOCTYPE html>
<!--
Copyright 2016 Ruhr-UniversitÃ¤t Bochum.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

     http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">

		<title>OPIV Client Verifier</title>



		<!-- Latest compiled and minified CSS -->
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css"
			  integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7"
			  crossorigin="anonymous">

		<!-- Optional theme -->
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap-theme.min.css"
			  integrity="sha384-fLW2N01lMqjakBkx3l/M9EahuwpSfeNvV63J5ezn3uZzapT0u7EYsXMjQV+0En5r"
			  crossorigin="anonymous">

		<link rel="stylesheet" href="css/opiv.css">
	</head>
	<body>
		<nav class="navbar navbar-inverse navbar-fixed-top">
			<div class="container">
				<div class="navbar-header">
					<a class="navbar-brand" href="./">OPIV</a>
				</div>
				<div id="navbar" class="collapse navbar-collapse">
					<ul class="nav navbar-nav">
						<li class="active"><a href="#" onclick="OPIV.clear();">Client Verifier</a></li>
						<li><a href="op-verifier.html">OP Verifier</a></li>
					</ul>
				</div><!--/.nav-collapse -->
			</div>
		</nav>

		<div class="container">

			<div class="page-headline">
				<h1>Client Verifier</h1>
				<p class="lead"></p>
			</div>

			<div>
				<h3>Introduction</h3>
				<p>This OpenID-Connect test tool can be used to check OpenID Connect Clients for known vulnerabilities.
				It is in a very early stage of development, where only the bare essentials are implemented. The missing
				parts especially include UI feedback from tests and the learning phase, configuration help during the
				learning phase, and the robustness of frontend-server interactions. These deficiencies will be addressed
				shortly.</p>
				<p>In the meantime we provide a configuration for a demo OpenID Connect Client. The configuration can be
				loaded by pressing the 'Load Demo Config' button below. Afterwards the usual learning and test phase can
				be run with the buttons below the configuration form.</p>
				<form id="rp-demo-form" action="javascript:;" onsubmit="javascript:OPIV.loadDemo();">
					<button class="btn btn-default" type="submit" value="Load Demo Config">Load Demo Config</button>
				</form>
			</div>

			<hr>

			<div>
				<h3>Legend</h3>
				<dl style="" class="dl-horizontal">
					<dt><img alt="NOT_RUN" src="img/NOT_RUN.png" width="20"></dt>
					<dd><b>Test not run</b></dd>
					<dt><img alt="PASS" src="img/PASS.png" width="20"></dt>
					<dd><b>Test passed</b></dd>
					<dt><img alt="FAIL" src="img/FAIL.png" width="20"></dt>
					<dd><b>Test failed</b></dd>
					<dt><img alt="UNDETERMINED" src="img/UNDETERMINED.png" width="20"></dt>
					<dd><b>Test outcome undetermined</b></dd>
				</dl>
			</div>

			<hr>

			<div class="row">
				<div class="learn-controls col-sm-12">
					<p>Test ID: <tt id="test-id-display">not-loaded</tt><br>
					Honest OP Identity: <tt id="honest-op-id-display">not-loaded</tt><br>
					Evil OP Identity: <tt id="evil-op-id-display">not-loaded</tt></p>

					

					<form id="rp-learn-form" action="javascript:;" onsubmit="javascript:OPIV.learnRP();">
						<fieldset>
							<legend>Client Parameters</legend>
							<div class="form-group">
								<div class="col-sm-2">
									<label for="url-client-target">Login-Site URL:</label>
								</div>
								<div class="col-sm-10">
									<input class="form-control" type="url" name="url-client-target" form="rp-learn-form" required size="80">
								</div>
							</div>
							<div class="form-group">
								<div class="col-sm-2">
									<label for="input-field-name">Input-Field Name:</label>
								</div>
								<div class="col-sm-10">
									<input class="form-control" type="text" name="input-field-name" form="rp-learn-form" size="80">
								</div>
							</div>
							<div class="form-group">
								<div class="col-sm-2">
									<label for="selenium-script">Selenium Script:</label>
								</div>
								<div class="col-sm-10">
									<textarea class="form-control" name="selenium-script" form="rp-learn-form" rows="10" cols="80"></textarea>
								</div>
							</div>
							<div class="form-group">
								<div class="col-sm-2">
									<label for="url-client-target-success">Success URL:</label>
								</div>
								<div class="col-sm-10">
									<input class="form-control" type="url" name="url-client-target-success" size="80">
								</div>
							</div>
							<div class="form-group">
								<div class="col-sm-2">
									<label for="honest-user-needle">Honest User Needle:</label>
								</div>
								<div class="col-sm-10">
									<input class="form-control" type="text" name="honest-user-needle" size="80">
								</div>
							</div>
							<div class="form-group">
								<div class="col-sm-2">
									<label for="evil-user-needle">Evil User Needle:</label>
								</div>
								<div class="col-sm-10">
									<input class="form-control" type="text" name="evil-user-needle" size="80">
								</div>
							</div>
							<div class="form-group">
								<div class="col-sm-2">
									<label for="user-profile-url">User Profile URL:</label>
								</div>
								<div class="col-sm-10">
									<input class="form-control" type="text" name="user-profile-url" size="80">
								</div>
							</div>
							<div class="col-sm-2"></div>
							<div class="col-sm-10">
								<button class="btn btn-default" type="submit" value="Learn">Learn</button>
							</div>
						</fieldset>
					</form>
				</div>
			</div>

			<div id="learn-report">
				<script>
					function toggleLearnLog() {
						var containerToHide = document.getElementById("learn-log");
						if (containerToHide.style.display === "none") {
							containerToHide.style.display = null;
						} else {
							containerToHide.style.display = "none";
						}
					}
				</script>
				<a onclick="toggleLearnLog();">
					<b>Learning Log</b>
					<img id="learn-status" alt="NOT_RUN" src="img/NOT_RUN.png" width="20">
				</a>
				<div id="learn-log">

				</div>
			</div>

			<div id="test-report">
				<!-- The Test Report is filled by the JS logic -->
			</div>

		</div>


		<script src="https://code.jquery.com/jquery-1.12.0.min.js"></script>

		<!-- Latest compiled and minified JavaScript -->
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"
				integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS"
				crossorigin="anonymous">
		</script>

		<!-- own scripts -->
		<script src="js/verify-controller.js"></script>
		<script>
			OPIV.createRPTestPlan();
		</script>
	</body>
</html>
