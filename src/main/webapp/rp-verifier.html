<!DOCTYPE html>
<!--
Copyright 2016 Ruhr-UniversitÃ¤t Bochum.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

     http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">

		<title>PrOfESSOS</title>



		<!-- Latest compiled and minified CSS -->
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css"
			  integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7"
			  crossorigin="anonymous">

		<!-- Optional theme -->
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap-theme.min.css"
			  integrity="sha384-fLW2N01lMqjakBkx3l/M9EahuwpSfeNvV63J5ezn3uZzapT0u7EYsXMjQV+0En5r"
			  crossorigin="anonymous">

		<link rel="stylesheet" href="css/opiv.css">
	</head>
	<body>
		<nav class="navbar navbar-inverse navbar-fixed-top">
			<div class="container">
				<div class="navbar-header">
					<a class="navbar-brand" href="./">PrOfESSOS</a>
				</div>
				<div id="navbar" class="collapse navbar-collapse">
					<ul class="nav navbar-nav">
						<li class="active"><a href="#" onclick="OPIV.clear();">Client Verifier</a></li>
						<!--<li><a href="op-verifier.html">OP Verifier</a></li>-->
					</ul>
				</div><!--/.nav-collapse -->
			</div>
		</nav>

		<div class="container">

			<div class="page-headline">
				<h1>Evolution of Single Sign-On Security: Systematically Attacking and Defending OpenID Connect</h1>
				<p class="lead"></p>
			</div>

				<h2>Abstract</h2>

				<p>The IETF OpenID Connect standard is one of the most important 
					Single Sign-On (SSO) protocols and is used by companies like Amazon, 
					Google, Microsoft and PayPal.</p>
				<p>In this paper we describe a new-found <i>IdP Confusion</i> vulnerability that abuses a lack in the
					specification and belongs to a novel class of attacks called <i>Cross-Phase Attacks</i>. We present
					that <i>all</i> OpenID Connect libraries are vulnerable to this attack. In addition, we
					show how to adapt attacks known from other SSO protocols to OpenID 
					Connect. 63% of the tested OpenID Connect implementations are vulnerable
					to these attacks.</p>
				<p>We address the existing problems regarding the SSO security with our 
					novel tool named PrOfESSOS (Practical Offensive Evaluation of Single 
					Sign-On Services), a <i>fully automated</i> Evaluation-as-a-Service for 
					SSO. PrOfESSOS introduces a generic approach to improve the security of 
					OpenID Connect implementations by systematically detecting 
					vulnerabilities and preventing such attacks.</p>
				<p>We cooperate with the OAuth and OpenID Connect working group to integrate PrOfESSOS as a part of the
					implementation certification process.</p>
				
				<h2>How to use the USENIX Demo Site?</h2>
				<ol>
					<li>Click on the <i>Load USENIX Config</i> button.</li>
					<ul>
						<li>This fills out the URL of the tested Client (SP), the user needle, the profile URL, and
							completes Stage 1 of PrOfESSOS.</li>
					</ul>
					<li>Cick on the button <i>Learn</i></li>
					<ul>
						<li>This starts the configuration evaluation and completes Stage 2.</li>
					</ul>
					<li>Cick on the button <i>Run all Tests</i> to complete Stage 3.</li>
					<ul>
						<li>This starts all available tests, and thus, executes the attacks.</li>
					</ul>
				</ol>

				<form id="rp-demo-form" action="javascript:;" onsubmit="javascript:OPIV.loadDemo();">
					<button class="btn btn-default" type="submit" value="Load USENIX Config">Load USENIX Config</button>
				</form>

			<hr>

			<h2>Legend</h2>
			<dl style="" class="dl-horizontal">
				<dt><img alt="NOT_RUN" src="img/NOT_RUN.png" width="20"></dt>
				<dd><b>Test not run</b></dd>
				<dt><img alt="PASS" src="img/PASS.png" width="20"></dt>
				<dd><b>Test passed</b></dd>
				<dt><img alt="FAIL" src="img/FAIL.png" width="20"></dt>
				<dd><b>Test failed</b></dd>
				<dt><img alt="UNDETERMINED" src="img/UNDETERMINED.png" width="20"></dt>
				<dd><b>Test outcome undetermined</b></dd>
			</dl>

			<hr>

			<h2>Stage 1: Setup - Client Parameters</h2>
			<div class="row">
				<div class="learn-controls col-sm-12">
					<form id="rp-learn-form" action="javascript:;" onsubmit="javascript:OPIV.learnRP();">
						<fieldset>
							<legend>OP Parameters</legend>
							<p>Test ID: <tt id="test-id-display">not-loaded</tt><br>
							Honest OP Identity: <tt id="honest-op-id-display">not-loaded</tt><br>
							Evil OP Identity: <tt id="evil-op-id-display">not-loaded</tt></p>
							
							<legend>Client Parameters</legend>
							<div class="form-group">
								<div class="col-sm-2">
									<label for="url-client-target">Login-Site URL:</label>
								</div>
								<div class="col-sm-10">
									<input class="form-control" type="url" name="url-client-target" form="rp-learn-form" required size="80">
								</div>
							</div>
							<div class="form-group">
								<div class="col-sm-2">
									<label for="input-field-name">Input-Field Name:</label>
								</div>
								<div class="col-sm-10">
									<input class="form-control" type="text" name="input-field-name" form="rp-learn-form" size="80">
								</div>
							</div>
							<div class="form-group">
								<div class="col-sm-2">
									<label for="selenium-script">Selenium Script:</label>
								</div>
								<div class="col-sm-10">
									<textarea class="form-control" name="selenium-script" form="rp-learn-form" rows="10" cols="80"></textarea>
								</div>
							</div>
							<div class="form-group">
								<div class="col-sm-2">
									<label for="url-client-target-success">Success URL:</label>
								</div>
								<div class="col-sm-10">
									<input class="form-control" type="url" name="url-client-target-success" size="80">
								</div>
							</div>
							<div class="form-group">
								<div class="col-sm-2">
									<label for="honest-user-needle">Honest User Needle:</label>
								</div>
								<div class="col-sm-10">
									<input class="form-control" type="text" name="honest-user-needle" size="80">
								</div>
							</div>
							<div class="form-group">
								<div class="col-sm-2">
									<label for="evil-user-needle">Evil User Needle:</label>
								</div>
								<div class="col-sm-10">
									<input class="form-control" type="text" name="evil-user-needle" size="80">
								</div>
							</div>
							<div class="form-group">
								<div class="col-sm-2">
									<label for="user-profile-url">User Profile URL:</label>
								</div>
								<div class="col-sm-10">
									<input class="form-control" type="text" name="user-profile-url" size="80">
								</div>
							</div>
							<div class="col-sm-2"></div>
							<div class="col-sm-10">
								
							</div>
						</fieldset>
					</form>
				</div>
			</div>

			
			<h2>Stage 2: Configuration Evaluation</h2>
			<button class="btn btn-default" type="submit" value="Learn" form="rp-learn-form">Learn</button>
			
			<div id="learn-report">
				<script>
					function toggleLearnLog() {
						var containerToHide = document.getElementById("learn-log");
						if (containerToHide.style.display === "none") {
							containerToHide.style.display = null;
						} else {
							containerToHide.style.display = "none";
						}
					}
				</script>
				<a onclick="toggleLearnLog();">
					<b>Learning Log</b>
					<img id="learn-status" alt="NOT_RUN" src="img/NOT_RUN.png" width="20">
				</a>
				<div id="learn-log">

				</div>
			</div>

			
			<h2>Stage 3: Tests and Attacks</h2>
			<form id="rp-runall-form" action="javascript:;" onsubmit="javascript:OPIV.runAllTests();">
				<button class="btn btn-default" type="submit" value="Run all Tests" form="rp-runall-form">Run all Tests</button>
			</form>

			<div id="test-report">
				<!-- The Test Report is filled by the JS logic -->
			</div>

		</div>


		<script src="https://code.jquery.com/jquery-1.12.0.min.js"></script>

		<!-- Latest compiled and minified JavaScript -->
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"
				integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS"
				crossorigin="anonymous">
		</script>

		<!-- own scripts -->
		<script src="js/verify-controller.js"></script>
		<script>
			OPIV.createRPTestPlan();
		</script>
	</body>
</html>
